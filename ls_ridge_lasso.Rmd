---
title: "LS, Lasso, Ridge Regression"
author: "Adina Zhang"
date: "April 4, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(caret)
library(glmnet)
```

```{r, message = FALSE}
# Load dataset
life_analysis = read_csv("./Life Expectancy Data.csv") %>% 
  janitor::clean_names() %>%
  select(-country, -population, -infant_deaths, -measles, -polio,
         -percentage_expenditure) %>% 
  mutate(log_gdp = log(gdp + 0.1),
         log_under_five = log(under_five_deaths + 0.1),
         status = factor(status),
         status = fct_recode(status, "0" = "Developing", "1" = "Developed"),
         status = as.integer(status)) %>% 
  select(-gdp, -under_five_deaths)

life_analysis = na.omit(life_analysis)

# Split data into test and training datasets
set.seed(1)
train_rows = createDataPartition(life_analysis$life_expectancy,
                                 p = 0.75,
                                 list = F)

# Training Set
train_df = life_analysis[train_rows,]
# Test Set
test_df = life_analysis[-train_rows,]

```


## Least Squares Model

```{r}
# Set up cross validation measures
ctrl1 = trainControl(method = "cv", number = 10)

set.seed(2)
# Least squares model
ls.fit = train(life_expectancy ~.,
               data = train_df,
               method = 'lm',
               trControl = ctrl1)
# MSE Calculation
predy.lm = predict(ls.fit$finalModel, newdata = test_df)
mse = ((predy.lm - train_df$life_expectancy)^2)
```

